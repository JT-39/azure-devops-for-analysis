# Overall Workflow

## Before you start - a note on data storage

- If possible, when working with Git and DevOps, store your data in SQL server and read just the data you need from the server.

- If you store data files in your repo, Git will version control all your data as well. This means that:
  + If you delete your data they will still be in your Git history and therefore recoverable. This is problematic if you have data which you need to be able to delete.
  + If your data files are large, your git repository becomes large. This increases the time and internet needed to interact with your work on DevOps, particularly for `clone`, `push` and `pull` commands. It also makes R Shiny apps slow to deploy.
  
- If you add data to Git and DevOps you should also think about who else this gives data access to: anyone with access to the DevOps project will gain access to the data in your area and DevOps project access is managed centrally. Therefore it is a bad place for personal or sensitive data because you cannot control access to it.

## Starting a DevOps project

- Make a project in DevOps

- Clone the repository to a local directory. Open your desired folder in File Explorer, right click and select "Git Bash here".
```sh
git clone <project_name>
```

We recommend that, to get the most from DevOps, you use it from the start of a project. This allows a continuous process of making small changes and having them QA'd, instead of doing a huge QA right at the end. However, you may have started a repository locally and wish to put it on DevOps. In that case you can push to DevOps.

- Add the DevOps repository as your "remote"
```sh
git remote add origin <repo_URL>
```

- Push your local changes up to DevOps (make sure you've committed your changes first!)
```sh
git push -u origin --all <repo_URL>
```

## Making Branches

- Work may be assigned to you as a "Work Item". In DevOps use the link to make new branch. To correct a bug, prefix the branch name with "bug/". To add new functionality, prefix the branch name with "feature/".

- Make sure your master branch is up to date.
```sh 
git pull
```
Your local repository will now "know" about the branch you just made.

- Checkout the branch you made on DevOps (make sure the branch names are the same).
```sh 
git checkout <your_branch_name>
```

## Making Changes

- Make your code changes

- Commit your changes. You can make as many commits as you need to. As ever, make 
them roughly self-contained chunks that would be easy for someone to review piece by piece.
```sh
git add <file_list>
```
```sh
git commit -m "Commit message"
```

## Merging
- When you've made enough changes to complete your work item checkout the master 
branch in your local repository do a pull in case anyone else had made changes.
```sh 
git checkout master
```
```sh 
git pull
```

- Switch back to your working branch. Merge any changes from master.
```sh 
git checkout <your_branch_name>
```
```sh 
git merge master
```

- Sort out any merge conflicts.
```sh 
git status
``` will list the files that have merge conflicts. Open the files with 
the conflicts, and search them for "<<<<". Everything from the next line up until 
a line of "====" will be from the master branch. Everything from the "====" line 
until ">>>>" will be from your working branch. Work through the code to make sure 
that you keep all the necessary changes. There may be changes from master and your branch that you want to keep, so don't just idly delete things!
Add and commit the changes.
```sh 
git add <file_to_be_merged>
```
```sh 
git commit -m "Commit message (it's advised to mention the merge)"
```

## Push changes to DevOps

- Push your changes to DevOps
```sh 
git push
```

- On DevOps make a pull request for your branch

- Have someone review your work. If any changes are required, go back to [Making Changes](#making-changes) and work from there again.

- Merge your branch into Master

- Find some more work, go back to the top and start again, Sisyphus!